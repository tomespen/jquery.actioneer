var base;$.widget("efi.actioneer",{options:{keyTrigger:"shift+space",jsonActions:"",searchResults:"",currentAction:""},_create:function(){"use strict";base=this;var e="";base._container=$('<div id="jquery-actioneer"><div id="jquery-actioneer-inner"><input type="text" id="jquery-actioneer-search" /><ul id="jquery-actioneer-autocomplete"></ul></div></div>').appendTo("body"),$("#jquery-actioneer-go").click(function(){base.selectaction()}),$("body").on("keypress",null,base.options.keyTrigger,function(){$("#jquery-actioneer-inner").children("span").remove(),$("#jquery-actioneer").show(),$("#jquery-actioneer-search").val(""),$("#jquery-actioneer-search").focus(),base.searchactions()}),window.navigator.userAgent.indexOf("Firefox")>=0&&$("body").on("keydown",function(t){e+=t.which,e.length>4&&(e=e.substr(-4)),"1632"===e&&($("#jquery-actioneer-inner").children("span").remove(),$("#jquery-actioneer").show(),$("#jquery-actioneer-search").val(""),$("#jquery-actioneer-search").focus(),base.searchactions(),e="")}),$("#jquery-actioneer-search").on("keydown",null,"esc",function(){base.resetstate(),$("#jquery-actioneer").hide(),$("#jquery-actioneer-autocomplete").hide()}),$("#jquery-actioneer-search").on("keypress",null,base.options.keyTrigger,function(){base.resetstate(),$("#jquery-actioneer").hide(),$("#jquery-actioneer-autocomplete").hide()}),$("#jquery-actioneer-search").on("keyup",function(e){$("#jquery-actioneer-search").val().match(/^\s+/g)&&$("#jquery-actioneer-search").val(""),38!==e.which&&40!==e.which&&13!==e.which&&37!==e.which&&39!==e.which&&base.searchactions()}),$("#jquery-actioneer-search").on("keydown",function(e){if(13===e.which)base.selectaction();else if(8===e.which){var t=$("#jquery-actioneer-search").val();""===t&&(base.options.currentAction="",$("#jquery-actioneer-inner span").remove())}}),$("#jquery-actioneer-search").on("keydown",null,"up",function(){base.actionsmove("up")}),$("#jquery-actioneer-search").on("keydown",null,"down",function(){base.actionsmove("down")}),base._trigger("created",null,"Plugin created ...")},_init:function(){"use strict";""===base.options.jsonActions?base.buildactionslist():".json"===base.options.jsonActions.substr(-5)?base.buildactionslistjsonfile():base.buildactionslistjson(),base._trigger("init",null,"Plugin initiated")},buildactionslist:function(){"use strict";var e=[];$(".actioneer").each(function(){var t={name:$(this).text(),action:$(this).attr("href")};e.push(t)}),base.options.actions=e,base._trigger("buildComplete",null,"Action build completed.")},buildactionslistjson:function(){"use strict";var e=$.parseJSON(base.options.jsonActions),t=[],o=0,n=0,s={},a=0,i=0,c={},r={};for(o=0,n=e.length;n>o;o+=1){if(void 0===e[o].subactions)s={name:e[o].name,action:e[o].action};else{for(c=[],a=0,i=e[o].subactions.length;i>a;a+=1)r={name:e[o].subactions[a].name,action:e[o].subactions[a].action},c.push(r);s={name:e[o].name,action:e[o].action,subactions:c}}t.push(s)}base.options.actions=t},buildactionslistjsonfile:function(){"use strict";$.getJSON(base.options.jsonActions,function(e){var t=[],o=0,n=0,s={},a=0,i=0,c={},r={};for(o=0,n=e.length;n>o;o+=1){if(void 0===e[o].subactions)s={name:e[o].name,action:e[o].action};else{for(c=[],a=0,i=e[o].subactions.length;i>a;a+=1)r={name:e[o].subactions[a].name,action:e[o].subactions[a].action},c.push(r);s={name:e[o].name,action:e[o].action,subactions:c}}t.push(s)}base.options.actions=t}),base._trigger("buildComplete",null,"Action build completed.")},searchactions:function(){"use strict";var e="",t=[],o="",n=!1,s="",a=0,i=0,c=0,r=0,u="";if($("#jquery-actioneer-autocomplete").show(),s=$("#jquery-actioneer-search").val(),""===base.options.currentAction)for(a=0,i=base.options.actions.length;i>a;a+=1){for(u=base.options.actions[a].name,o=".*",c=0,r=s.length;r>c;c+=1)o+=s.charAt(c)+".*";e=u.match(new RegExp(o,"gi")),null!==e&&t.push(base.options.actions[a]),base.options.searchResults=t}else for(a=0,i=base.options.currentAction.subactions.length;i>a;a+=1){for(u=base.options.currentAction.subactions[a].name,o=".*",c=0,r=s.length;r>c;c+=1)o+=s.charAt(c)+".*";e=u.match(new RegExp(o,"gi")),null!==e&&t.push(base.options.currentAction.subactions[a]),base.options.searchResults=t}if($("#jquery-actioneer-autocomplete").text(""),t.length)for(a=0,i=t.length;i>a;a+=1)try{$("#jquery-actioneer-autocomplete").append("<li>"+t[a].name+"</li>")}catch(l){n=!0,base.debug(l)}n===!0&&base.debug("Autocomplete error."),base.bindmouseactions()},actionsmove:function(e){"use strict";var t=-1,o=$("#jquery-actioneer-autocomplete li").length;$("#jquery-actioneer-autocomplete li").each(function(e){$(this).hasClass("selected")===!0&&(t=parseInt(e,10))}),"down"===e?(t+=1,$("#jquery-actioneer-autocomplete li").removeClass("selected"),$("#jquery-actioneer-autocomplete li").eq(parseInt(t,10)).addClass("selected"),t>o-1&&(t=-1)):"up"===e&&(0===t?($("#jquery-actioneer-autocomplete li").removeClass("selected"),t=-1):-1===t?(t=o-1,$("#jquery-actioneer-autocomplete li").removeClass("selected"),$("#jquery-actioneer-autocomplete li").eq(parseInt(t,10)).addClass("selected")):(t-=1,$("#jquery-actioneer-autocomplete li").removeClass("selected"),$("#jquery-actioneer-autocomplete li").eq(parseInt(t,10)).addClass("selected")))},selectaction:function(){"use strict";var e,t=-1;$("#jquery-actioneer-autocomplete li").each(function(e){$(this).hasClass("selected")===!0&&(t=parseInt(e,10))}),""!==$("#jquery-actioneer-search").val()&&-1===t&&base.options.searchResults.length>=0&&(t=0,$("#jquery-actioneer-autocomplete li").eq(parseInt(t,10)).addClass("selected")),(""!==$("#jquery-actioneer-search").val()||-1!==t)&&(""===base.options.currentAction&&void 0===base.options.searchResults[t].subactions?base.execaction(t):""===base.options.currentAction?(base.options.currentAction=base.options.searchResults[t],e=$("#jquery-actioneer-autocomplete li.selected").text(),$("#jquery-actioneer-search").before("<span>"+e+"</span>"),$("#jquery-actioneer-search").val(""),base.searchactions()):base.execaction(t))},bindmouseactions:function(){"use strict";$("#jquery-actioneer-autocomplete li").on("mouseenter",function(){$("#jquery-actioneer-autocomplete li.selected").removeClass("selected"),$(this).addClass("selected")}),$("#jquery-actioneer-autocomplete li").on("click",function(){base.selectaction()})},resetstate:function(){"use strict";$("#jquery-actioneer").hide(),$("#jquery-actioneer-search").show(),$("#jquery-actioneer-search").val(""),base.options.currentAction=""},execaction:function(e){"use strict";var t;""!==base.options.currentAction&&$("#jquery-actioneer-search").before("<span> - </span>"),t=$("#jquery-actioneer-autocomplete li.selected").text(),$("#jquery-actioneer-search").before("<span>"+t+"</span>"),"number"==typeof e&&($("#jquery-actioneer-autocomplete, #jquery-actioneer-search").hide(),$("#jquery-actioneer-search").before("<span>...kj√∏rer!</span>"),location.href=base.options.searchResults[e].action),base.resetstate()},debug:function(e){"use strict";console.log(e)},_destroy:function(){"use strict";$.widget.prototype.destroy.call(this)},_setOption:function(e,t){"use strict";this._super(e,t)}}),$.widget.bridge("actioneer",$.efi.actioneer);